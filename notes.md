
## Simplicial complexes

-
### Homology

Let $C_k = \mathbb{Z}(\Sigma_k)$ be the free abelian group generated by the set of $k$-simplices. There is a boundary maps of abelian groups $$\partial_k: C_k \to C_{k-1}$$ $$\partial_k = \sum_{i=0}^{n}(-1)^id_i$$ The boundary maps have the property that $\partial_{k-1}\circ \partial_k = 0$.

This forms a chain complex of abelian groups $C_{\bullet} = \{C_k\}, \, (k\geq 0)$ connected by boundary maps $\partial_k$. The $k$-th homology group of the simplicial complex is the $k$-homology of the chain complex, $$H_k^{\Delta}(X) = \mbox{Ker}(\partial_k)/\mbox{Im}(\partial_{k+1}).$$ Given an abelian group $A$, the simplicial homology groups with coefficients in $A$ is the homology of the chain complex $C_{\bullet}\otimes A$: $$H_k^{\Delta}(X;A) = H_k(C_{\bullet}\otimes A)$$

The Betti numbers are defined as $$\beta(X)_k = \dim _FH_k^{\Delta}(X;F)$$ wher $F$ is a field. The $k$-th Betti number for $k>1$ measures the number of $k$-dimensional holes in the topological realization of $X$. The zeroth betti number $\beta(X)_0$ measures the number of connected components. 

### The boundary matrix and Betti numbers

Since the groups $C_k(X)$ are equipped with bases $\Sigma_k$, the operators $\partial_k$ can be expressed as matrices $D(k)$ whose rows are indexed by $\Sigma_{k-1}$ and columns are indexed by $\Sigma_{k}$. 

For $\sigma \in \Sigma_{k}$ and $\tau \in \Sigma_{k-1}$ the entry $D(k)_{\sigma\tau} = 0$ if $\tau \not\subset \sigma$ and $=(-1)^i$ if $\tau \subset \sigma$ and $\tau$ is obtained from $\sigma$ by removing the $i$-th element of the subset $\sigma$.

$$\beta(X)_k = \dim_F\left( \frac{\mbox{Ker}\,D(k)}{\mbox{Im}\,D(k+1)} \right) = \mbox{len}(\Sigma_k) - \mbox{rank}(D(k)) - \mbox{rank}(D(k+1))$$

### Python implementation

An abstract simplicial complex can be encoded as a set of sets. In python we implement this as a list of lists.

For example one can implement a simplcial complex structure of a circle as follows:

$X$ = ["x","y","z", "xy", "yz", "xz"]

To every simplex in $X$ we can associate a simplex "tree" consisting of all its faces in lower dimensions. We use a list of lists to use a write a tree. The simplex tree associated with the simplex "xy" is ["xy", ["x",[]], ["y",[]]]. The simplex trees of all the simplices can be combined to form a $X.\mbox{dim}+1$-partitite graph (also written as a list of lists), called the facetree, encoding the face maps in its entirety. The facetree of $X$ is ["xy",["x",[]],"yz",["y",[],"z",[]], "xz",["x",[]],["z",[]]].
   

### The scomplex class

In the implementation it is not necessary to enter all the simplices. The scomplex class will automatically include all the lower dimensional faces of a simplex. The class scomplex has attributes simplices (lists down the simplices of all dimensions), Sigma($i$) = list of $i$ dimensional simplcies, and betti = list of betti numbers from dimesion $0$ to dimension of the complex.

The $0$-th Betti number is the number of connected components and the $i$-th Betti number (for $i>0$) is the number of $i$-dimensional holes in the topological realization of the simplicial complex.




## Delta Complexes (semi-simplicial sets)

A delta complex (or semi-simplcial sets) is a more flexible notion than a simplicial complex where simplices are no longer uniquely determined by their vertices. A vertex set $\{0,\ldots,m \}$ can for form the vertices of more than one $m+1$-simplex. A delta complex is defined as a collection of sets $K_n, \, n\geq 0$. We think of each $K_n$ as the set of $n$-simplices. For every $n$ there are face maps $d_j:K_n \to K_{n-1},\,\, 0\leq j \leq n$, satisfying the identity

\begin{equation}
d_id_j = d_{j-1}d_i \,\,(i < j)
\end{equation}

Simplicial homology and betti numbers are defined similarly. Define abelian groups of $k$-chains $C_k = \mathbb{Z}(K_n)$ and $$\partial_k: C_k \to C_{k-1}$$ $$\partial_k = \sum_{i=0}^{n}(-1)^id_i$$

### Torus

A torus can be obtained from $I \times I$ by identifying the sides in the way prescribed above. This can be given a delta complex structure as follows. 
$K_0 = \{x\}, K_1 = \{a,b,c\}, K_2 = \{A,B\}$

$d_0(a) = d_1(a) = x$, $d_0(b) = d_1(b) = x$, $d_0(c) = d_1(c) = x$

$d_0(A) = a, d_1(A) = b, d_2(A) = c$

$d_0(B) = a, d_1(B) = b, d_2(B) = c$

Notice that this is not a valid simplicial complex as the triangles $A$ and $B$ have one vertex $x$, which violatesthe rule that every $n$-simplex must contain $n+1$-vertices. The minimum triangulation of a torus in the simplicial complex setting requires atleast seven vertices.

### Python implementation 

The delta complex data structure consists of a collection of simplices (the sets $K_n$ in definition) implemented as a list of sets and a structure tree containing information about the all the face maps of all the simplices. For example the topological circle can be given a delta complex strucure as follows. 

$X = (\mbox{simplices}, \mbox{structuretree})$

$X.\mbox{simplices}= $  [{"x"},{"a"}]  
(one $0$-simplex "x" and one $1$-simplex "a")

$X.\mbox{structuretree} = $["a",["x",[]],["x",[]]]  
($d_0$("a") = $d_1$("a") = "x")

(Note that this is not a simplicial complex)

Delta complexes allows for very compact representations of space which would otherwise require a large number of simplices for a simplcial complex representation.

A delta complex structure on a torus can be implemented as:

$T.\mbox{simplices} = $ [{'x'},{'a','b','c'},{'A','B'}]

$T.\mbox{structuretree} = $ [['A',['a',['x',[]],['x',[]]],['b',['x',[]],['x',[]]],['c',['x',[]],['x',[]]]],['B', ['a',['x',[]],['x',[]]],['b',['x',[]],['x',[]]],['c',['x',[]],['x',[]]]]]

### The boundary matrix and Betti numbers

Using bases $K_n$ for $C_n$ the boundary operator $\partial_k:C_k \to C_{k-1}$ can be represented using a $\mbox{len}(K_{k-1}) \times \mbox{len}(K_k)$ matrix $D(k)$.  The matrix can be computed using the formula for the boundary map $\partial_k$. 

As in the simplcial complex case
$$\beta_k = \mbox{len}(K_k) - \mbox{rank}(D(k)) - \mbox{rank}(D(k+1))$$


### The semi_sset class

## Simplicial Sets

A simplicial set is a generalization of a delta complex which has degenerate simplices along with the usual simplices in various dimensions. A simplicial set $X$ consists of sets of $n$-simplices $X_n$ for $n \geq 0$. There are face maps and degeneracy maps $$d_i : X_n \to X_{n-1}, \,\, (0\leq i \leq n)$$ $$s_i: X_n \to X_{n+1},\,\, (0\leq i \leq n)$$ A simplex in the image of a degeneracy is a degenerate simplex. The face and degeneracy maps satisfy the following identities

\begin{equation}
d_id_j = d_{j-1}d_i \,\, (i < j)\\
d_is_j = s_{j-1}d_i \,\, (i < j)\\
d_is_j  = \mbox{id}\,\, (i=j,j+1)\\
d_is_j  = s_jd_{i-1}\,\, (i > j)\\
s_is_j = s_js_{i-1}, (i > j)\\
\end{equation}

A simplicial set has degenerate simplices in all (infinitely many) dimensions. However in our implementation we truncate at the topdimension. 

### Simplicial complex to simplicial set

A simplicial complex is naturally a simplicial set. Given a simplicial complex $S = \Sigma_0, \Sigma_1, \ldots$, we define a simplicial set $X$ with $$X_0 = \Sigma_0$$ and $$X_n = \Sigma_n \cup \left(\bigcup_{i=0}^n s_i(X_{n-1})\right)$$ the face map $d_i$ acts on a simplex by removing the $i$-the vertex and the degeneracy map $s_i$ acts by repeating the $i$-th vertex.

## Quotients

### Example
The real advantage of simplicial sets over simplicial complexes or delta complexes is that the category of simplicial sets is closed under colimits, i.e. one can do quotient constructions on simplicial sets. 

For example, a sphere is the identification space of a triangle with its boundary identified to a point. There is no delta complex structure representing this identification since the faces of a $2$-simplex must be $1$-simplices and there are no $1$-simplices in this representation. The idea is to use degenerate $1$-simplices. We can use a simplicial set structure like

$X_0 = \{x\}$

$X_2 = \{A\}$

These are the non-degenerate simplices. 

The face maps 

$d_0(A) = d_1(A) = d_2(A) = s_0(x)$. 

### Collapsing a simplex

Let $X$ be a simplicial set with $x$ a simplex. To construct the simplicial set quotient $X/x$, first introduce a new vertex $x_0$ and replace all instances of $x$, i.e. its faces and degeneracies, with degeneracies of $x_0$. 

Let $x$ be a simplex of dimension $n$ (i.e. $x \in X_n$). For $k\geq 0$ define the non-degenerate face set of dimension $k$ of $x$, inductively, $$F_{x,k} = \bigcup_{i=0}^{k+1}d_i(F_{x,k+1}),\,\,\, (k < n)$$ and $F_{x,n} = \{x\}$, $F_{x,k} = \emptyset$ for $ k > n$. The complete face set of dimension $k$ is defined as $$\bar{F}_{x,k} = F_{x,k} \cup \left( \bigcup_{i=0}^{k-1}s_i(\bar{F}_{x,k-1})\right),\,\,\, (k > 0)$$ and $\bar{F}_{x,0} = F_{x,0}$.

To define the simplicial set $X'=(X/x)$, define the simplex set $(X/x)_k$ as $$X'_k = (X_k - \bar{F}_{x,k})\cup \{s_0^k(x_0)\}$$ where $s_0^k$ is the zeroth degeneracy applied $k$-times. We are just removing all the faces and degeneracies of $x$ in dimension $k$ and explicitly adding $s_0^k(x_0)$ which is the only $k$-dimesnsional degeneracy of $x_0$.

The simplicial maps are defined as follows: for any simplex $y \in X'_k$,
$$d'_i(y) = d_i(y) \,\, \mbox{if} \,\, d_i(y) \notin \bar{F}_{x,k-1}$$
$$d'_i(y) = s_0^{k-1}(x_0)\,\, \mbox{otherwise}$$
$$ $$
$$s'_i(y) = s_i(y)\,\,\mbox{if}\,\,s_i(y)\notin \bar{F}_{x,k+1}$$
$$s'_i(y) = s_i^{k+1}(x_0)\,\,\mbox{otherwise}$$

In other words, if a face or degeneracy of $y$ is an instance of $x$ (i.e. an iterated face or degeneracy of $x$), we make the face or degeneracy of $y$ to be equal to the degeneracy of $x_0$ in the corresponding dimension.

### Betti number computation

The boundary matrix $D(k)$ is a $\mbox{len}(X_{k-1}) \times \mbox{len}(X_k)$ matrix computed in the same way as in the delta complex case. 

Let $X_k^{nd} \subset X_k$ be the subset of non-degenerate simplices of dimension $k$. 

In the betti number computation, let $Z^{\circ}_k =  \mbox{Ker}\,D(k) \cap X_k^{nd}$ be the set of non-degenerate $k$-cycles. Let $B^{\circ}_k = \mbox{Im}\,\left( D(k+1)|_{X_{k+1}^{nd}} \right) = \mbox{Im}\,D(k+1) \cap X_k^{nd}$. The homology group $$H_k(X) = \frac{ Z^{\circ}_k}{B^{\circ}_k}.$$

The betti numbers can be computed as
$$\beta(X)_k = \dim_F\left( \frac{Z^{\circ}_k}{B^{\circ}_k} \right) = \mbox{len}(X_k^{nd}) - \mbox{rank}(D(k)) - \mbox{rank}(D(k+1))$$

## Python implementation

We use a list of sets to write the set of simplices $X_k$. We use a downward multi-tree to encode all the face maps and an upward multi-tree to encode all the degeneracy maps. 

## Reducing a simplicial set via iterative collapses

If $X$ is a cell complex and $A$ is a contractible subcomplex then the quotient map $X \to X/A$ is a homotopy equivalence and hence induces an isomorphism in homology. In computational topology it is an undecidable problem to dtermine if a space is contractible. What one can do instead is check if it is homologically trivial. Then $X\to X/A$ induces an isomorphism in homology. This follows from the existence of a long exact sequence:

$$\cdots \to  H_n(A) \to H_n(X) \to H_n(X/A) \to H_{n-1}(A) \to H_{n-1}(X) \to \cdots \to H_1(X) \to H_1(X/A) \to \widetilde{H}_0(A) \to \widetilde{H}_0(X) \to \widetilde{H}_0(X/A) \to 0$$ where 
$H_0 \simeq \widetilde{H}_0\oplus\mathbb{Z}$.

From this we see that if $A$ is contractible; $H_n(A) = 0 ,\, n >0; \widetilde{H}_0(A) = 0$; then $H_n(X) \simeq H_n(X/A)$ for $n > 0$ and $H_0(X) \simeq H_0(X/A)$. More generally, for a non-contractible space $A$ it may me possible to piece together the homology of $X$ from the homology of $A$ and $X/A$ using the long exact sequence. 

In the context of a simplicial set we can replace $X$ with the quotient $X/x$ where $x$ is a sub simplicial set generated by a simplex $x$ of $X$. If $x$ is has trivial homology (i.e. $H_n^{\Delta}(x) = 0 , n > 0$ and $H_0^{\Delta}(x) = \mathbb{Z}$) then the quotient simplcial map $X \to X/x$ induces isomorphism on homology. In the simplicial set class  add a reduce method that replaces $X$ with $X/x$ iteratively for all homologically trivial simplices $x$. The end result of the reduce function is then a sset with a much smaller representation and having the same betti numbers as the original one.

$$X \mapsto X/x_0 \mapsto (X/x_0)/x_1 \mapsto ((X/x_0)/x_1)/x_2 \mapsto \ldots \mapsto \mbox{red}(X)$$ The collapse operation is a series of quotient reductions where each step produces a homologically equivalent sset.


